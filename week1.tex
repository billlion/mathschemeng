\documentclass[11pt,a4paper]{article}

\usepackage[twoside,a4paper,hmarginratio=3:2,vmarginratio=1:1,bmargin=2.54cm]{
geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an inden

\usepackage{graphicx}
\usepackage{graphics}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{epstopdf}
\usepackage{longtable}
\usepackage{lscape}
%\usepackage{savepapr}
\usepackage{fancyhdr}
\usepackage{fancybox}
\usepackage{indentfirst}
\usepackage{ifthen}
\usepackage{comment}
\usepackage{flafter}
%%%\usepackage{reenumi}
\usepackage{bibentry}
%\usepackage{hyperref}

\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{makeidx}
\usepackage{bm}
\usepackage{multicol}
\usepackage{color}

\newcommand{\dif}{\mathsf{d}}

%%---------------------------------------------------------------  DJS Definitions 
\def\ffrac#1#2{\leavevmode\kern.1em
\raise.5ex\hbox{\the\scriptfont0 #1}\kern-.1em
/\kern-.15em\lower.25ex\hbox{\the\scriptfont0 #2}}
\def\half{\frac{1}{2}}
\def\hhalf{\ffrac{1}{2}}
\def\bA{\mathbf{A}}
\def\bB{\mathbf{B}}
\def\bC{\mathbf{C}}
\def\bD{\mathbf{D}}
\def\bI{\mathbf{I}}
\def\bP{\mathbf{P}}
\def\bX{\mathbf{X}}
\def\tough{$\!\!\!{}^\star\>$}
\newcommand{\R}{{\mathbb{R}}}


%% Change this boolean to true to compile solutions.
\newboolean{mynotes}
\setboolean{mynotes}{false}

%%---------------------------------------------------------------------------------------
\begin{document}

\begin{center} 
{\bf Maths Problems for 2011--12 | CHEN10072 \\
David Silvester \\
17 January 2012}
\end{center}

\hrule
\smallskip
\section*{week 14}

\begin{enumerate}

\item\label{q1167} Let
\[ \bA \,=\, \left( \begin{array}{rr} 1 &2 \\ -2 &2 \end{array} \right) \quad
\hbox{and} \quad
\bB \,=\, \left( \begin{array}{rr} -3 &1 \\ -1 &-4 \end{array} \right).\]

Compute the following matrices:
	\begin{enumerate}
	\item $\bA+ 2\bB$.  Is it true that $ \bA + 2\bB= 2\bB + \bA$?
	\item $\bA^T+  \bB^T$. Is it true that $( \bA + \bB)^T = \bA^T + \bB^T$?
	\item $\bA \bB$ and $\bB \bA$.    Is it true that $ \bA \bB= \bB \bA$?
	\item $\bB^T \bA^T$.  Is it true that $(\bA \bB)^T= \bB^T \bA^T$?
	\end{enumerate}

\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill

{\bf Solution}

\noindent\hrulefill

}{}%

\item\label{qdjsp1}
A {\it permutation} matrix  $\bP_{ij}$ is generated by interchanging rows (or colums) 
of an {\it identity} matrix $\bI$, e.g.
$$  \bP_{12} =  \left ( \begin{array}{ccc}  0 & 1 & 0\\  1 & 0 & 0\\  0 & 0 & 1 \end{array} \right ),  \quad
  \bP_{13} =  \left ( \begin{array}{ccc}  0 & 0 & 1\\  0 & 1 & 0\\  1 & 0 & 0 \end{array} \right ).  $$

Let $\bA$ be the matrix
$$  \bA =  \left ( \begin{array}{ccc}  11 & 12 & 13\\  21 & 22 & 23 \\  31 & 32 & 33 \end{array} \right ).$$
\begin{enumerate}
\item Compute the products $\bP_{12} \bA$,  $\bP_{13} \bA$,   $\bA\bP_{12}$ and  $\bA\bP_{13}$.
What do you observe?
\item  Show that  $\bP_{12} \bP_{12}^T = \bI$.  (This means that $\bP_{12}^T$ is the inverse of   $\bP_{12}$---this
property characterizes a  permutation matrix.)
\item Show that the matrix $\bP= \bP_{12} \bP_{13} $ is also a permutation matrix. (Compute $\bP$
explicitly  and show that $\bP \bP^T=\bI$.)
\item Compute  the determinant of $\bP_{12}$ and that of $\bP_{13}$.
\item\tough Use the fact that  $\hbox{det}(\bA \bB) =  \hbox{det}(\bA) \times \hbox{det}(\bB)$ to
prove that the determinant of a permutation matrix is $\pm 1$. \emph{Hint: 
use the fact that transposing a matrix does not change its determinant.}


\end{enumerate}
\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill
{\bf Solution}
\noindent\hrulefill
}{}%


\end{enumerate}
\vfill\eject
%%---------------------------------------------------------------------------------------
\section*{week 16}
\begin{enumerate}
 

\item\label{q1171}  If
 \[\bA \,= \left( \begin{array}{rr} 1&2\\-2&4 \end{array} \right),\] calculate
$\bA^{-1}$.   By direct calculation show that
 $\bA\bA^{-1} =\bA^{-1}\bA=\bI $.

\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill
{\bf Solution}
\noindent\hrulefill
}{}%


\item\label{q1172} Consider the linear equations
\begin{eqnarray*}
3x\,+\,2y&=&1\\ 
-2x\,+\,5y&=&-7.
\end{eqnarray*}
	\begin{enumerate}
	\item Write this equations in matrix form, i.e. $\bA \mathbf{x}=\mathbf{b}$.
	\item Calculate $\bA^{-1}$ and, by direct calculation, show $\bA \bA^{-1} = \bA^{-1} \bA =\bI $.
	\item Use $\bA^{-1}$ to obtain the values of $x$ and $y$.
	\item Check your working by showing your answer fits the original equations.
	\end{enumerate}

\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill
{\bf Solution}
\noindent\hrulefill
}{}%

\item\label{qdjsp2}
\begin{enumerate}
\item
Evaluate the following  $2\times 2$  determinants:
 $$ d_1= \left| \begin{array}{rr} 1&2 \\ -2 & 5 \end{array} \right| , \qquad
	d_2=  \left| \begin{array}{rr}  \ffrac{5}{9} &- \ffrac{2}{9}  \\  \ffrac{2}{9}  &  \ffrac{1}{9} \end{array} \right|. $$ 
How are  $d_1$ and $d_2$ related and why?
\item\tough
Next, evaluate the following  $3\times 3$ determinants:
 $$  d_3 = \left| \begin{array}{rrr} 1&-2&1 \\ 2 & 3 & -1\\-1&-2&2 \end{array} \right|, \qquad
	d_4=  \left| \begin{array}{rrr}2 & 3 & -1\\  1&-2&1 \\ -1&-2&2 \end{array} \right|. $$ 
How are  $d_3$ and $d_4$  related and why? \emph{Hint:  Use the properties of permutation matrices.}
\end{enumerate}
\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill
{\bf Solution}
\noindent\hrulefill
}{}%



\item\label{q1205}\tough
Suppose that you have square matrices, $\bA, \bB$ and $\bC$, with the properties
$\bA\bB=\bI$ and $\bC\bA =\bI$, where $\bI$ is the identity matrix.
Use this information to prove that $\bC = \bB$.

You may assume that  $\bD \bI = \bI\bD = \bD$  for any square matrix $\bD$. You may
not assume that $\bA \bA^{-1} = \bA^{-1} \bA = \bI$. 
The  point of the question is to establish that the
left-hand and right-hand inverses are identical and the above  statement assumes this.
\emph{Hint: Do not use  inverse matrices in this question. 
Also do not look at matrix components --- consider
matrices as single objects and make use of their multiplication properties. 
The proof is just a few lines long!}


\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill

{\bf Solution}

\noindent\hrulefill

}{}%

\end{enumerate}

\vfill\eject
%%---------------------------------------------------------------------------------------
\section*{week 17}

\begin{enumerate}

\item\label{q1206}
Potassium chromate is recovered from a methanol/water solution by evaporation, crystallisation
and filtration. The total mass flows, in units of kg~h$^{-1}$, is $E$ for evaporation, $F$ for filtration and $C$
for crystallisation. The material balance equations for potassium chromate, water and methanol are
\begin{eqnarray*}
1125&=&1.06C\,+\,0.3F\\
2250&=&0.75E\,+\,0.08C\,+\,0.4F\\
1125&=&0.25E\,+\,0.06C\,+\,0.3F .
\end{eqnarray*}
\begin{enumerate}
 \item Write the system of  equations in the form 
       $ \bA \mathbf{x}=\mathbf{b}, $
        where {\bf A} is a $3\times 3$ matrix, {\bf x} is a column vector of the unknown quantities and {\bf b}
is a column vector with known coefficients.
        \item Apply  Gaussian elimination to show that $E$, $C$ and $F$ satisfy the upper triangular system
       $$\left ( \begin{array}{rrrr}
         1.06 & 0 & 0.3  \\
        0 &  0.75& 0.37736 \\
        0  & 0 & 0.15723
         \end{array} \right )
   \left ( \begin{array}{c}
        C \\ E \\ F
            \end{array} \right) =
   \left ( \begin{array}{r}
        1125.00 \\ 2165.10 \\ 339.62  
            \end{array} \right) .$$
          \item  Hence calculate $E$, $C$ and $F$ using  back-substitution.
           \item  Calculate the determinant  of the matrix $\bA$. 
           \emph{Hint: Adding multiples of one row to another does not change the determinant of a matrix.}

       \end{enumerate}

\item\label{qdjsx1} 
It is known  that the number of floating point operations (flop) required to solve
an $n\times n$ system of linear equations using Gaussian elimination
is approximately $2 n^3 /3$ for large values of $n$. Estimate the 
size of the biggest system that 
can be solved for \pounds 10,000 if it costs \pounds 1,000 an hour to
use the IBM Roadrunner supercomputer which has a calculation rate of $10^{15}$ flop/sec. 
(This is called a {\it petaflop}. Conventional laptop computers run  at  a  {\it gigaflop},  that is $10^{9}$ flop/sec.)

\item\label{q1207} Consider the linear equation system:
\begin{eqnarray*}
x\,+\,y\,+\,z&=&3\\
x\,-\,y\,+\,2z&=&2\\
2y\,-\,z&=&5
\end{eqnarray*}
            \begin{enumerate}
            \item Write the system of  equations in the form of $\bA \mathbf{x}=\mathbf{b}$.
            \item  Solve for $x,y,z$ using Gaussian elimination.
             Can you explain this result? 
            \end{enumerate}

\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill
{\bf Solution}
\noindent\hrulefill
}{}%


\item\label{qdjsx2} \tough
Consider the coefficient matrix
 $$ \bA = \left ( \begin{array}{rrrr}
         2 & 4 & -2  \\
        2 &  8& 4 \\
        1  & -2 & -1
         \end{array} \right )$$
   Using Gaussian elimination,  solve the three distinct systems 
  $$ \bA  \mathbf{x}_1=\mathbf{e}_1,\qquad  \bA  \mathbf{x}_2=\mathbf{e}_2, 
   \qquad\bA  \mathbf{x}_3=\mathbf{e}_3,\qquad\qquad\qquad\qquad\qquad $$
  where $\mathbf{e}_1=  \left[ \begin{array}{c} 1 \\ 0\\ 0 \end{array} \right]$, 
   $\mathbf{e}_2=  \left[ \begin{array}{c} 0 \\ 1\\ 0 \end{array} \right]$
    $\mathbf{e}_3=  \left[ \begin{array}{c} 0 \\ 0\\ 1 \end{array} \right]$, \\[2ex]
  so as to  compute the columns of the matrix   $\bX$ satisfying $\bA \bX = \bI$.  (Note that this is
  clever way to compute the inverse matrix $\bX= \bA^{-1}$.)  


\ifthenelse{\boolean{mynotes}}{
\noindent\hrulefill
{\bf Solution}
\noindent\hrulefill
}{}%



\end{enumerate}

\vfill\eject
%%---------------------------------------------------------------------------------------

\section*{week 18}
\begin{enumerate}



\item\label{qdjsx3}
A paint company is trying to use up excess quantities of four shades
of green paint by mixing them to form a more popular shade. One gallon
of the new paint will be made up of $x_1$ gallons of paint~1, $x_2$
gallons of paint~2 etc. Each of the paints is made up of four
pigments. If each number repesents a percentage, 
the mixture giving the more popular shade is the solution of 
the system of equations
$$\left ( \begin{array}{rrrr}
         0 & 80 & 10 & 10 \\
        80 &  0 & 30 & 10 \\
        16 & 20 & 60 & 72 \\
         4 &  0 &  0 &  8 \end{array} \right )
   \left ( \begin{array}{c}
        x_1 \\ x_2 \\ x_3 \\ x_4 
            \end{array} \right) =
   \left ( \begin{array}{r}
        27 \\ 40 \\ 31 \\ 2 
            \end{array} \right) .$$
Find the optimal mixture by solving the system using Gaussian elimination 
with {\it partial pivoting}. (This means that you interchange rows at every step
to put the biggest number in modulus  on the diagonal. In this example,
 at the first stage of the elimination you would interchange row one with row two.)


You can check your results   in MATLAB (see also the following  exercise) by typing the command sequence
\begin{verbatim}
>> A=[0,80,10,10;80,0,30,10;16,20,60,72;4,0,0,8],  [L,U,P] = lu(A),
>> b=[27;40;31;2], x=A\b, 
\end{verbatim}


\item\label{qdjsx4}
Given a matrix
$$\bA= \left ( \begin{array}{rrr}
         4.00 & -2.00 & 3.00\\
        -2.00 &  7.25 & -2.75 \\
         3.00 & -2.75 & 11.50 \
         \end{array} \right ) . $$
  By setting 
$$  \mathbf{L} =  \left ( \begin{array}{rrr}
         1 & 0 & 0\\
        \ell_{21} &  1 &  0 \\
        \ell_{31} & \ell_{32} & 1
         \end{array} \right ),  \quad
          \mathbf{U} =  \left ( \begin{array}{rrr}
         u_{11} & u_{12} & u_{13} \\
        0  &  u_{22} & u_{23} \\
        0 & 0  & u_{33}    \end{array} \right )
        $$
 and forming the product,
find a lower triangular matrix $ \mathbf{L}$ with ones on the diagonal,
and an upper  triangular matrix $ \mathbf{U}$ such that 
$$  \mathbf{L} \mathbf{U} = \bA.$$

 This is how Gaussian elimination is implemented in MATLAB,
 the matrix $\mathbf{U} $ is the upper triangular matrix formed by GE, the
 matrix $\mathbf{L} $ contains the row mutipliers used at each stage
 of the elimination, and the matrix $\mathbf{P}$  is the permutation 
 matrix   needed  to effect the partial pivoting.
You can check your results by typing the MATLAB command sequence
\begin{verbatim}
>> A=[4,-2,3;-2,7.25,-2.75;3,-2.75,11.5], [L,U,P] = lu(A),
\end{verbatim}



\end{enumerate}

\vfill\eject
%%---------------------------------------------------------------------------------------

\end{document}
